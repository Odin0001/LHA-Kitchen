import{u as D,r as o,j as e,Q as u,G as $,p as P,_ as T,d as _}from"./index-56e58669.js";import{g as B,v as E,r as G,u as L,a as Q}from"./v4-803aab98.js";import{g as z}from"./index-e3d5d3f4-e6ed04b4.js";import{S as A}from"./Spinner-82b55c3e.js";const J=()=>{const d=z(),f=D(),[a,m]=o.useState([]),[g,b]=o.useState(""),[p,h]=o.useState({}),[y,l]=o.useState(!1),[r,i]=o.useState({title:"",name:"",quantity:""});function j(t){t.preventDefault(),r.title!==""&&r.name!==""&&r.quantity!==""&&(m([...a,r]),i({name:"",quantity:""}))}const w=t=>{a.splice(t,1),m([...a])};async function v(){if(l(!0),p.length>1){l(!1),u.error("Maximum images allowed are 6");return}async function t(n){return new Promise((q,R)=>{const I=B(),S=`${d.currentUser.uid}-${n.name}-${E()}`,U=G(I,S),x=L(U,n);x.on("state_changed",s=>{const k=s.bytesTransferred/s.totalBytes*100;switch(console.log("Upload is "+k+"% done"),s.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},s=>{R(s)},()=>{Q(x.snapshot.ref).then(s=>{q(s)})})})}const c=await Promise.all([...p].map(n=>t(n))).catch(n=>{l(!1),u.error("Images not uploaded")}),N={items:a,desc:g,imgUrls:c,timestamp:$(),userRef:d.currentUser.uid},C=await P(T(_,"recipes"),N);l(!1),u.success("Recipe created"),f(`/recipes/${C.id}`)}return y?e.jsx(A,{}):e.jsxs("main",{className:"max-w-xl mx-auto px-2 my-8",children:[e.jsx("h1",{className:"text-4xl text-center mt-6 font-bold text-green-600 mt-6",children:"Create Recipe"}),e.jsxs("div",{className:"rounded-lg bg-green-500 p-4 mt-6",children:[e.jsxs("form",{className:"grid grid-cols-6 items-center text-gray-700",children:[e.jsx("input",{className:"col-span-6 mb-4 p-3 border border-gray-300 focus:border-2 focus:border-green-600 outline-none rounded",type:"text",placeholder:"Recipe Title",required:!0,value:r.title,onChange:t=>i({...r,title:t.target.value})}),e.jsx("input",{className:"col-span-3 p-3 border border-gray-300 focus:border-2 focus:border-green-600 outline-none rounded placeholder:lg:text-lg placeholder:text-sm",type:"text",placeholder:"Item with Unit",required:!0,value:r.name,onChange:t=>i({...r,name:t.target.value})}),e.jsx("input",{className:"col-span-2 p-3 border border-gray-300 focus:border-2 focus:border-green-600 outline-none rounded mx-3 placeholder:lg:text-lg placeholder:text-sm",type:"number",placeholder:"Quantity",required:!0,min:"0",value:r.quantity,onChange:t=>i({...r,quantity:t.target.value})}),e.jsx("button",{className:"text-white text-xl bg-green-700 hover:bg-green-600 p-3 text-xl rounded transition duration-500 ease",type:"button",onClick:j,children:"+"}),e.jsxs("div",{className:"my-3 col-span-6",children:[e.jsx("p",{className:"mb-2 text-xl font-semibold",children:"Image"}),e.jsx("input",{type:"file",id:"images",accept:".jpg, .png, .jpeg",required:!0,onChange:t=>h(t.target.files),className:"w-full bg-white px-3 py-1.5 border border-gray-300 rounded"})]})]}),e.jsxs("ul",{children:[a.map((t,c)=>e.jsxs("li",{className:"my-4 w-full flex justify-between bg-green-300 rounded",children:[e.jsxs("div",{className:"p-4 w-full flex justify-between",children:[e.jsx("span",{children:t.name}),e.jsx("span",{children:t.quantity})]}),e.jsx("button",{onClick:()=>w(c),className:"ml-8 p-4 border-l-2 border-green-700 hover:bg-green-400 w-16 transition duration-500 ease",children:"X"})]},c)),e.jsx("textarea",{cols:"30",rows:"10",placeholder:"How to Prepare",required:!0,value:g,onChange:t=>b(t.target.value),className:"w-full mt-6 rounded border border-gray-300 focus:border-2 focus:border-green-600 outline-none resize-none p-4"}),e.jsx("button",{type:"button",onClick:v,className:"w-full py-2 mt-4 rounded text-white text-center bg-green-700 hover:bg-green-600 text-xl transition duration-500 ease",children:"Create Recipe"})]})]})]})};export{J as default};
